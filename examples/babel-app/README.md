# Babel Plugin Example

This example demonstrates the usage of `@soda-gql/plugin-babel` in a standalone application.

## Features

- ✅ Model definitions with transforms
- ✅ Operation slices (query/mutation/subscription)
- ✅ Composed operations from multiple slices
- ✅ Zero-runtime GraphQL query generation
- ✅ Type-safe operations

## Setup

```bash
# Install dependencies (from root)
bun install

# Generate GraphQL system files
cd examples/babel-app
bun run codegen
```

## Usage

### Development

```bash
bun run dev
```

### Build

```bash
bun run build
```

The build process uses Babel to transform soda-gql definitions into runtime code.

## Project Structure

```
babel-app/
├── src/
│   ├── models.ts          # GraphQL model definitions
│   ├── slices.ts          # Operation slices
│   ├── operations.ts      # Composed operations
│   └── index.ts           # Entry point
├── graphql-system/
│   └── index.ts           # Generated by codegen
├── schema.graphql         # GraphQL schema
├── .babelrc.json          # Babel configuration
├── package.json
└── tsconfig.json
```

## Key Concepts

### Models

Models define reusable GraphQL fragments with data transformations:

```typescript
export const userModel = gql.default(({ model }, { $ }) =>
  model.User(
    { variables: [$('categoryId').scalar('ID:?')] },
    ({ f, $ }) => [f.id(), f.name()],
    (selection) => ({ id: selection.id, name: selection.name }),
  ),
);
```

### Slices

Slices define domain-specific queries/mutations/subscriptions:

```typescript
export const userSlice = gql.default(({ slice }, { $ }) =>
  slice.query(
    { variables: [$('id').scalar('ID:!')] },
    ({ f, $ }) => [f.user({ id: $.id })(({ f }) => [f.id()])],
    ({ select }) => select(['$.user'], (result) => result),
  ),
);
```

### Operations

Operations compose multiple slices into executable GraphQL operations:

```typescript
export const getUserQuery = gql.default(({ operation }, { $ }) =>
  operation.query(
    {
      operationName: 'GetUser',
      variables: [$('userId').scalar('ID:!')],
    },
    ({ $ }) => ({ user: userSlice.build({ id: $.userId }) }),
  ),
);
```

## Type Checking

Type check from the example directory:

```bash
bun run ../../node_modules/.bin/tsc -b
```

Or from the root:

```bash
cd ../..
bun typecheck
```
